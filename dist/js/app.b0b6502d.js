(function(e){function t(t){for(var a,s,l=t[0],o=t[1],u=t[2],d=0,m=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&m.push(r[s][0]),r[s]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);c&&c(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,l=1;l<n.length;l++){var o=n[l];0!==r[o]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=o;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e623"),n("e379"),n("5dc8"),n("37e1");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("hm-nav-bar",{attrs:{user:e.user,"menu-expanded":e.menuExpanded},on:{"sign-out-clicked":e.signOut,"menu-clicked":e.switchMenuState}}),n("main",[n("router-view")],1)],1)},i=[],s=(n("96cf"),n("1da1")),l=n("d4ec"),o=n("bee2"),u=n("2591"),c={apiKey:"AIzaSyAM1q7ES_ilLBnoK66mlXOJMLelJhjEbuQ",authDomain:"hiramark-c06a4.firebaseapp.com",databaseURL:"https://hiramark-c06a4-default-rtdb.firebaseio.com",projectId:"hiramark-c06a4",storageBucket:"hiramark-c06a4.appspot.com",messagingSenderId:"770997750386",appId:"1:770997750386:web:a60ceb6473b8379cb0d0eb",measurementId:"G-ZL48QK8FZH"};u["a"].initializeApp(c);var d=u["a"],m=function(){function e(){Object(l["a"])(this,e),this.auth=d.auth()}return Object(o["a"])(e,[{key:"onStateChanged",value:function(e){this.auth.onAuthStateChanged(e)}},{key:"signUp",value:function(e,t){return this.auth.createUserWithEmailAndPassword(e,t)}},{key:"signIn",value:function(e,t){return this.auth.signInWithEmailAndPassword(e,t)}},{key:"signOut",value:function(){return this.auth.signOut()}}]),e}(),p=new m,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{staticClass:"navbar has-shadow",attrs:{id:"nav",role:"navigation","aria-label":"main navigation"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"navbar-brand"},[n("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[e._v("hiramark")]),n("a",{staticClass:"navbar-burger burger",class:{"is-active":e.menuExpanded},attrs:{role:"button",id:"navbar-burger","aria-label":"menu","aria-expanded":"false","data-target":"navbar-links"},on:{click:e.onMenuClicked}},[n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}})])],1),n("div",{staticClass:"navbar-menu",class:{"is-active":e.menuExpanded},attrs:{id:"navbar-links"}},[e.user?n("div",{staticClass:"navbar-end"},[n("router-link",{staticClass:"navbar-item",attrs:{to:{name:"bookmark_new"}}},[n("hm-icon",{attrs:{name:"bookmark"}}),n("span",[e._v("ブックマークする")])],1),n("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[n("a",{staticClass:"navbar-link"},[n("hm-icon",{attrs:{name:"user"}})],1),n("div",{staticClass:"navbar-dropdown is-right"},[n("a",{staticClass:"navbar-item",on:{click:e.signOut}},[n("hm-icon",{attrs:{name:"sign-out-alt"}}),n("span",[e._v("サインアウト")])],1)])])],1):n("div",{staticClass:"navbar-end"},[n("div",{staticClass:"navbar-item"},[n("router-link",{staticClass:"button is-text",attrs:{to:{name:"sign_in"}}},[n("hm-icon",{attrs:{name:"sign-in-alt"}}),n("span",[e._v("サインイン")])],1)],1),n("div",{staticClass:"navbar-item"},[n("router-link",{staticClass:"button is-text",attrs:{to:{name:"sign_up"}}},[n("span",{staticClass:"icon"},[n("hm-icon",{attrs:{name:"user-plus"}})],1),n("span",[e._v("サインアップ")])])],1)])])])])},f=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon"},[n("i",{class:["fas",e.nameClass]})])},b=[],g=(n("b0c0"),{name:"hm-icon",props:{name:String},computed:{nameClass:function(){return"fa-".concat(this.name)}}}),k=g,x=n("2877"),C=Object(x["a"])(k,v,b,!1,null,null,null),w=C.exports,_={name:"hm-nav-bar",components:{hmIcon:w},props:{user:Object,menuExpanded:Boolean},methods:{signOut:function(){this.$emit("sign-out-clicked")},onMenuClicked:function(){this.$emit("menu-clicked",this.menuExpanded)}}},y=_,O=Object(x["a"])(y,h,f,!1,null,null,null),E=O.exports,j={name:"app",components:{hmNavBar:E},data:function(){return{user:null,menuExpanded:!1}},created:function(){var e=this;p.onStateChanged((function(t){e.user=t})),this.$router.beforeEach((function(t,n,a){e.menuExpanded=!1,a()}))},methods:{signOut:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p.signOut();case 2:e.$router.push({name:"home"});case 3:case"end":return t.stop()}}),t)})))()},switchMenuState:function(e){this.menuExpanded=!e}}},S=j,U=Object(x["a"])(S,r,i,!1,null,null,null),V=U.exports,$=n("8c4f"),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e.user?n("span",[e._v("こんにちは"+e._s(e.user.email)+"さん")]):n("span",[e._v("ログインしていません")])])},I=[],R={name:"home",data:function(){return{user:null}},created:function(){var e=this;p.onStateChanged((function(t){e.user=t}))}},T=R,A=Object(x["a"])(T,P,I,!1,null,null,null),B=A.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("hm-page-title",{attrs:{title:"サインアップ"}}),n("section",{staticClass:"section"},[n("form",{staticClass:"container"},[n("hm-text-field",{attrs:{type:"email",placeholder:"メールアドレス",icon:"envelope"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),n("hm-text-field",{attrs:{type:"password",placeholder:"パスワード",icon:"lock"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:function(t){return t.preventDefault(),e.signUp(t)}}},[e._v(" サインアップ ")])])])],1)])],1)},L=[],F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero is-primary"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v(e._s(e.title))])])])])},D=[],J={name:"hm-page-title",props:{title:String}},N=J,K=Object(x["a"])(N,F,D,!1,null,null,null),q=K.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[e.label?n("label",{staticClass:"label"},[e._v(e._s(e.label))]):e._e(),n("p",{staticClass:"control",class:{"has-icons-left":e.icon}},["checkbox"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.innerValue,expression:"innerValue"}],staticClass:"input",class:{"is-danger":e.error},attrs:{placeholder:e.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(e.innerValue)?e._i(e.innerValue,null)>-1:e.innerValue},on:{change:[function(t){var n=e.innerValue,a=t.target,r=!!a.checked;if(Array.isArray(n)){var i=null,s=e._i(n,i);a.checked?s<0&&(e.innerValue=n.concat([i])):s>-1&&(e.innerValue=n.slice(0,s).concat(n.slice(s+1)))}else e.innerValue=r},e.onChanged]}}):"radio"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.innerValue,expression:"innerValue"}],staticClass:"input",class:{"is-danger":e.error},attrs:{placeholder:e.placeholder,type:"radio"},domProps:{checked:e._q(e.innerValue,null)},on:{change:[function(t){e.innerValue=null},e.onChanged]}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.innerValue,expression:"innerValue"}],staticClass:"input",class:{"is-danger":e.error},attrs:{placeholder:e.placeholder,type:e.type},domProps:{value:e.innerValue},on:{change:e.onChanged,input:function(t){t.target.composing||(e.innerValue=t.target.value)}}}),e.icon?n("hm-icon",{staticClass:"is-small is-left",attrs:{name:e.icon}}):e._e()],1),e.error?n("p",{staticClass:"help is-danger"},[e._v(e._s(e.error))]):e._e()])},H=[],Q=(n("caad6"),{name:"hm-text-field",components:{hmIcon:w},props:{type:{type:String,label:String,default:"text",validator:function(e){return["text","email","password","search","url"].includes(e)}},placeholder:String,value:String,icon:String,error:String},computed:{innerValue:{get:function(){return this.value},set:function(e){this.value!==e&&this.$emit("input",e)}}},methods:{onChanged:function(e){this.$emit("change",e.target.value)}}}),W=Q,Z=Object(x["a"])(W,z,H,!1,null,null,null),G=Z.exports,X=(n("4160"),n("c975"),n("159b"),n("82a7")),Y=n.n(X),ee=function(){function e(){Object(l["a"])(this,e),this.auth=d.auth(),this.db=d.firestore()}return Object(o["a"])(e,[{key:"getCurrentUser",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.auth.currentUser){e.next=2;break}throw new Error("サインインしていません。サインインしてください");case 2:return e.next=4,this.db.collection("users").where("authId","==",this.auth.currentUser.uid).get();case 4:return t=e.sent,n=null,t.forEach((function(e){n=e.data(),n.id=e.id})),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"createUser",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={authId:t.uid,name:t.email.substr(0,t.email.indexOf("@")),gravatarUrl:Y.a.url(t.email)},e.next=3,this.db.collection("users").add(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),te=new ee,ne={name:"sign_up",components:{hmPageTitle:q,hmTextField:G},data:function(){return{email:null,password:null}},methods:{signUp:function(){var e=this;p.signUp(this.email,this.password).then((function(e){return te.createUser(e.user)})).then((function(){e.$router.push({name:"home"})})).catch((function(e){alert(e.message)}))}}},ae=ne,re=Object(x["a"])(ae,M,L,!1,null,null,null),ie=re.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("hm-page-title",{attrs:{title:"サインイン"}}),n("section",{staticClass:"section"},[n("form",{staticClass:"container"},[n("hm-text-field",{attrs:{type:"email",placeholder:"メールアドレス",icon:"envelope"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),n("hm-text-field",{attrs:{type:"password",placeholder:"パスワード",icon:"lock"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:function(t){return t.preventDefault(),e.signIn(t)}}},[e._v(" サインイン ")])])])],1)])],1)},le=[],oe={name:"sign_in",components:{hmPageTitle:q,hmTextField:G},data:function(){return{email:null,password:null}},methods:{signIn:function(){var e=this;p.signIn(this.email,this.password).then((function(){e.$router.push({name:"home"})})).catch((function(e){alert(e.message)}))}}},ue=oe,ce=Object(x["a"])(ue,se,le,!1,null,null,null),de=ce.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("hm-page-title",{attrs:{title:"ブックマークの登録"}}),n("section",{staticClass:"section"},[n("form",{staticClass:"container"},[n("hm-text-field",{attrs:{placeholder:"タイトル",error:e.titleError},on:{change:e.validateTitle},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),n("hm-text-field",{attrs:{type:"url",placeholder:"URL",error:e.urlError},on:{change:e.validateUrl},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),n("hm-text-field",{attrs:{placeholder:"コメント",error:e.commentError},on:{change:e.validateComment},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:function(t){return t.preventDefault(),e.addBookmark(t)}}},[e._v(" 登録する ")])])])],1)])],1)},pe=[],he=function(){function e(){Object(l["a"])(this,e),this.db=d.firestore()}return Object(o["a"])(e,[{key:"getBookmark",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.db.collection("users").doc(t.id).collection("bookmarks").where("url","==",n).get();case 2:if(a=e.sent,!a.empty){e.next=5;break}return e.abrupt("return",null);case 5:return r=null,a.forEach((function(e){r=e.data(),r.id=e.id})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"addBookmark",value:function(e,t){return t.bookmarkedAt=d.firestore.FieldValue.serverTimestamp(),this.db.collection("users").doc(e.id).collection("bookmarks").add(t)}}]),e}(),fe=new he,ve={name:"bookmark_new",components:{hmPageTitle:q,hmTextField:G},data:function(){return{title:null,url:null,comment:null,titleError:null,urlError:null,commentError:null}},methods:{addBookmark:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.validate(),n=e.titleError||e.urlError||e.commentError,!n){t.next=5;break}return alert("入力値が不正です。"),t.abrupt("return");case 5:return t.next=7,te.getCurrentUser();case 7:return a=t.sent,t.next=10,fe.getBookmark(a,e.url);case 10:if(r=t.sent,null==r){t.next=14;break}return alert("すでに登録されているURLです。"),t.abrupt("return");case 14:return i={title:e.title,url:e.url,comment:e.comment},t.prev=15,t.next=18,fe.addBookmark(a,i);case 18:e.$router.push({name:"home"}),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](15),alert(t.t0.message);case 24:case"end":return t.stop()}}),t,null,[[15,21]])})))()},validate:function(){this.validateTitle(this.title),this.validateUrl(this.url),this.validateComment(this.comment)},validateTitle:function(e){this.titleError=null,this.title?e.length>50&&(this.titleError="タイトルは50文字までです"):this.titleError="タイトルは必須です"},validateUrl:function(e){this.urlError=null,e||(this.urlError="URLは必須です")},validateComment:function(e){this.commentError=e&&e.length>150?"コメントは150文字までです":null}}},be=ve,ge=Object(x["a"])(be,me,pe,!1,null,null,null),ke=ge.exports;a["a"].use($["a"]);var xe=[{path:"/",name:"Home",component:B},{path:"/sign_up",name:"sign_up",component:ie},{path:"/sign_in",name:"sign_in",component:de},{path:"/bookmarks/new",name:"bookmark_new",component:ke}],Ce=new $["a"]({mode:"history",base:"/",routes:xe}),we=Ce;new a["a"]({router:we,render:function(e){return e(V)}}).$mount("#app")}});
//# sourceMappingURL=app.b0b6502d.js.map